"use strict";(globalThis.webpackChunksidis=globalThis.webpackChunksidis||[]).push([[1481],{5292:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>p,frontMatter:()=>s,metadata:()=>r,toc:()=>t});const r=JSON.parse('{"id":"notifications/sidis_change","title":"Sidis Change Integration","description":"Funcionalidad Implementada","source":"@site/docs/notifications/sidis_change.md","sourceDirName":"notifications","slug":"/notifications/sidis_change","permalink":"/docs/notifications/sidis_change","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/notifications/sidis_change.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Action Examples","permalink":"/docs/notifications/action_examples"}}');var i=a(4848),o=a(8453);const s={sidebar_position:3},l="Sidis Change Integration",d={},t=[{value:"Funcionalidad Implementada",id:"funcionalidad-implementada",level:2},{value:"C\xf3mo Funciona",id:"c\xf3mo-funciona",level:2},{value:"Flujo de Datos",id:"flujo-de-datos",level:3},{value:"Detecci\xf3n de Eventos",id:"detecci\xf3n-de-eventos",level:3},{value:"Configuraci\xf3n de WorkFlowConfig",id:"configuraci\xf3n-de-workflowconfig",level:2},{value:"Estructura Actualizada",id:"estructura-actualizada",level:3},{value:"Eventos Disponibles",id:"eventos-disponibles",level:2},{value:"Para People",id:"para-people",level:3},{value:"Para otros m\xf3dulos (ejemplos)",id:"para-otros-m\xf3dulos-ejemplos",level:3},{value:"Operaciones Soportadas",id:"operaciones-soportadas",level:3},{value:"Extracci\xf3n de Destinatarios",id:"extracci\xf3n-de-destinatarios",level:2},{value:"Para People",id:"para-people-1",level:3},{value:"Para otros m\xf3dulos",id:"para-otros-m\xf3dulos",level:3},{value:"Ejemplos de Configuraci\xf3n",id:"ejemplos-de-configuraci\xf3n",level:2},{value:"1. Email de Bienvenida para Nuevas Personas (POST)",id:"1-email-de-bienvenida-para-nuevas-personas-post",level:3},{value:"2. SMS de Confirmaci\xf3n para Updates (PUT/PATCH)",id:"2-sms-de-confirmaci\xf3n-para-updates-putpatch",level:3},{value:"3. Tarea Autom\xe1tica para Casos Nuevos (POST)",id:"3-tarea-autom\xe1tica-para-casos-nuevos-post",level:3},{value:"4. Email de Confirmaci\xf3n para Eliminaciones (DELETE)",id:"4-email-de-confirmaci\xf3n-para-eliminaciones-delete",level:3},{value:"Templates con Variables",id:"templates-con-variables",level:2},{value:"Email Template",id:"email-template",level:3},{value:"SMS Template",id:"sms-template",level:3},{value:"Ejemplos de Creaci\xf3n de Registros (type: &quot;task&quot;)",id:"ejemplos-de-creaci\xf3n-de-registros-type-task",level:2},{value:"5. Crear Tarea de Seguimiento",id:"5-crear-tarea-de-seguimiento",level:3},{value:"6. Crear Registro de Backup en People",id:"6-crear-registro-de-backup-en-people",level:3},{value:"7. Crear Lead en CRM",id:"7-crear-lead-en-crm",level:3},{value:"8. Crear Entrada de Auditor\xeda",id:"8-crear-entrada-de-auditor\xeda",level:3},{value:"9. Crear M\xfaltiples Registros",id:"9-crear-m\xfaltiples-registros",level:3},{value:"Variables Disponibles para Registros",id:"variables-disponibles-para-registros",level:3},{value:"Integraci\xf3n Autom\xe1tica",id:"integraci\xf3n-autom\xe1tica",level:2},{value:"Flujo de Operaciones HTTP",id:"flujo-de-operaciones-http",level:3},{value:"Logs del Sistema",id:"logs-del-sistema",level:2},{value:"Ejemplos de Logs por Operaci\xf3n",id:"ejemplos-de-logs-por-operaci\xf3n",level:3},{value:"Testing",id:"testing",level:2},{value:"1. Crear configuraci\xf3n",id:"1-crear-configuraci\xf3n",level:3},{value:"2. Crear una persona",id:"2-crear-una-persona",level:3},{value:"3. Verificar logs",id:"3-verificar-logs",level:3},{value:"Variables Disponibles en Templates",id:"variables-disponibles-en-templates",level:2},{value:"Compatibilidad",id:"compatibilidad",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"sidis-change-integration",children:"Sidis Change Integration"})}),"\n",(0,i.jsx)(n.h1,{id:"integraci\xf3n-sidischange-con-action-controller",children:"Integraci\xf3n SidisChange con Action Controller"}),"\n",(0,i.jsx)(n.h2,{id:"funcionalidad-implementada",children:"Funcionalidad Implementada"}),"\n",(0,i.jsxs)(n.p,{children:["La funci\xf3n ",(0,i.jsx)(n.code,{children:"sidisChanges"})," en ",(0,i.jsx)(n.code,{children:"libs.ts"})," ahora tiene ",(0,i.jsx)(n.strong,{children:"doble funcionalidad"}),":"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Mantiene la funcionalidad original"}),": Env\xeda peticiones a N8N"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Nueva funcionalidad"}),": Ejecuta workflows internos del Action Controller"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"c\xf3mo-funciona",children:"C\xf3mo Funciona"}),"\n",(0,i.jsx)(n.h3,{id:"flujo-de-datos",children:"Flujo de Datos"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Cambio en DB \u2192 sidisChanges() \u2192 N8N (original) + Workflow Interno (nuevo)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"detecci\xf3n-de-eventos",children:"Detecci\xf3n de Eventos"}),"\n",(0,i.jsx)(n.p,{children:"Los eventos se generan autom\xe1ticamente basados en:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"M\xf3dulo"}),": ",(0,i.jsx)(n.code,{children:"People"}),", ",(0,i.jsx)(n.code,{children:"Case"}),", ",(0,i.jsx)(n.code,{children:"Company"}),", etc."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Operaci\xf3n HTTP"}),": ",(0,i.jsx)(n.code,{children:"POST"}),", ",(0,i.jsx)(n.code,{children:"PUT"}),", ",(0,i.jsx)(n.code,{children:"DELETE"}),", ",(0,i.jsx)(n.code,{children:"PATCH"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Mapeo de Operaciones:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"POST"})," \u2192 ",(0,i.jsx)(n.code,{children:"Create"})," \u2192 Evento: ",(0,i.jsx)(n.code,{children:"peopleCreate"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"PUT"})," \u2192 ",(0,i.jsx)(n.code,{children:"Update"})," \u2192 Evento: ",(0,i.jsx)(n.code,{children:"peopleUpdate"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"DELETE"})," \u2192 ",(0,i.jsx)(n.code,{children:"Delete"})," \u2192 Evento: ",(0,i.jsx)(n.code,{children:"peopleDelete"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"PATCH"})," \u2192 ",(0,i.jsx)(n.code,{children:"Update"})," \u2192 Evento: ",(0,i.jsx)(n.code,{children:"peopleUpdate"})]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Formato del evento"}),": ",(0,i.jsx)(n.code,{children:"{moduleName}{MappedOperation}"})," (ej: ",(0,i.jsx)(n.code,{children:"peopleCreate"}),", ",(0,i.jsx)(n.code,{children:"peopleUpdate"}),")"]}),"\n",(0,i.jsx)(n.h2,{id:"configuraci\xf3n-de-workflowconfig",children:"Configuraci\xf3n de WorkFlowConfig"}),"\n",(0,i.jsx)(n.h3,{id:"estructura-actualizada",children:"Estructura Actualizada"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'{\r\n  "_id": "workflow_id",\r\n  "event": "peopleCreate", // moduleName + Operation\r\n  "actions": [\r\n    {\r\n      "id": "welcome_email",\r\n      "event": "email", // Mantener por compatibilidad\r\n      "actionId": "email_001", \r\n      "type": "email", // email|sms|whatsapp|task\r\n      // NUEVO: Para type "task", configuraci\xf3n de creaci\xf3n de registros\r\n      "targetModule": "Task", // M\xf3dulo donde crear el registro\r\n      "recordData": {         // Datos espec\xedficos del registro\r\n        "field1": "value1",\r\n        "field2": "{{variable}}"\r\n      }\r\n      "templateId": "template_id_opcional",\r\n      "segmentId": "segment_opcional",\r\n      "period": "oneShoot",\r\n      "startAt": "2025-10-06T12:00:00.000Z",\r\n      "shootBy": "peopleCreate"\r\n    }\r\n  ]\r\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"eventos-disponibles",children:"Eventos Disponibles"}),"\n",(0,i.jsx)(n.h3,{id:"para-people",children:"Para People"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"peopleCreate"})," - Cuando se hace ",(0,i.jsx)(n.code,{children:"POST /people"})," (crear persona)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"peopleUpdate"})," - Cuando se hace ",(0,i.jsx)(n.code,{children:"PUT /people/:id"})," o ",(0,i.jsx)(n.code,{children:"PATCH /people/:id"})," (actualizar persona)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"peopleDelete"})," - Cuando se hace ",(0,i.jsx)(n.code,{children:"DELETE /people/:id"})," (eliminar persona)"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"para-otros-m\xf3dulos-ejemplos",children:"Para otros m\xf3dulos (ejemplos)"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"caseCreate"})," (POST /cases), ",(0,i.jsx)(n.code,{children:"caseUpdate"})," (PUT/PATCH /cases/",":id","), ",(0,i.jsx)(n.code,{children:"caseDelete"})," (DELETE /cases/",":id",")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"companyCreate"})," (POST /companies), ",(0,i.jsx)(n.code,{children:"companyUpdate"})," (PUT/PATCH /companies/",":id","), ",(0,i.jsx)(n.code,{children:"companyDelete"})," (DELETE /companies/",":id",")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"productCreate"})," (POST /products), ",(0,i.jsx)(n.code,{children:"productUpdate"})," (PUT/PATCH /products/",":id","), ",(0,i.jsx)(n.code,{children:"productDelete"})," (DELETE /products/",":id",")"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"operaciones-soportadas",children:"Operaciones Soportadas"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"HTTP Method"}),(0,i.jsx)(n.th,{children:"Mapeo Interno"}),(0,i.jsx)(n.th,{children:"Evento Generado"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"POST"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Create"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{module}Create"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"PUT"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Update"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{module}Update"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"PATCH"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Update"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{module}Update"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"DELETE"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Delete"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{module}Delete"})})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"extracci\xf3n-de-destinatarios",children:"Extracci\xf3n de Destinatarios"}),"\n",(0,i.jsx)(n.h3,{id:"para-people-1",children:"Para People"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// El sistema extrae autom\xe1ticamente:\r\n{\r\n  name: data.name,\r\n  email: data.email, \r\n  phone: data.phone\r\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"para-otros-m\xf3dulos",children:"Para otros m\xf3dulos"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// Busca campos est\xe1ndar:\r\n{\r\n  name: data.name || data.title,\r\n  email: data.email,\r\n  phone: data.phone\r\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"ejemplos-de-configuraci\xf3n",children:"Ejemplos de Configuraci\xf3n"}),"\n",(0,i.jsx)(n.h3,{id:"1-email-de-bienvenida-para-nuevas-personas-post",children:"1. Email de Bienvenida para Nuevas Personas (POST)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'// Configurar workflow para cuando se hace POST /people (crear persona)\r\ndb.WorkFlowConfig.insertOne({\r\n  "event": "peopleCreate", // POST se mapea a Create\r\n  "actions": [\r\n    {\r\n      "id": "welcome_email",\r\n      "actionId": "welcome_001",\r\n      "type": "email",\r\n      "templateId": "673abc123def456789012345", // Template con variables {{name}}, {{email}}\r\n      "period": "oneShoot"\r\n    }\r\n  ]\r\n});\n'})}),"\n",(0,i.jsx)(n.h3,{id:"2-sms-de-confirmaci\xf3n-para-updates-putpatch",children:"2. SMS de Confirmaci\xf3n para Updates (PUT/PATCH)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'// Configurar workflow para cuando se hace PUT /people/:id (actualizar persona)\r\ndb.WorkFlowConfig.insertOne({\r\n  "event": "peopleUpdate", // PUT/PATCH se mapea a Update\r\n  "actions": [\r\n    {\r\n      "id": "update_sms",\r\n      "actionId": "sms_001",\r\n      "type": "sms",\r\n      "templateId": "673abc123def456789012346" // Template: "Hola {{name}}, tu informaci\xf3n ha sido actualizada"\r\n    }\r\n  ]\r\n});\n'})}),"\n",(0,i.jsx)(n.h3,{id:"3-tarea-autom\xe1tica-para-casos-nuevos-post",children:"3. Tarea Autom\xe1tica para Casos Nuevos (POST)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'// Configurar workflow para cuando se hace POST /cases (crear caso)\r\ndb.WorkFlowConfig.insertOne({\r\n  "event": "caseCreate", // POST se mapea a Create\r\n  "actions": [\r\n    {\r\n      "id": "followup_task", \r\n      "actionId": "task_001",\r\n      "type": "task",\r\n      "templateId": "673abc123def456789012347", // Template con t\xedtulo y descripci\xf3n\r\n      "startAt": new Date(Date.now() + 2*60*60*1000) // 2 horas despu\xe9s\r\n    }\r\n  ]\r\n});\n'})}),"\n",(0,i.jsx)(n.h3,{id:"4-email-de-confirmaci\xf3n-para-eliminaciones-delete",children:"4. Email de Confirmaci\xf3n para Eliminaciones (DELETE)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'// Configurar workflow para cuando se hace DELETE /people/:id (eliminar persona)\r\ndb.WorkFlowConfig.insertOne({\r\n  "event": "peopleDelete", // DELETE se mapea a Delete\r\n  "actions": [\r\n    {\r\n      "id": "deletion_email",\r\n      "actionId": "delete_001", \r\n      "type": "email",\r\n      "templateId": "673abc123def456789012348" // Template: "Tu cuenta ha sido eliminada"\r\n    }\r\n  ]\r\n});\n'})}),"\n",(0,i.jsx)(n.h2,{id:"templates-con-variables",children:"Templates con Variables"}),"\n",(0,i.jsx)(n.h3,{id:"email-template",children:"Email Template"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'db.Template.insertOne({\r\n  "_id": ObjectId("673abc123def456789012345"),\r\n  "name": "Bienvenida Email",\r\n  "subject": "\xa1Bienvenido {{name}}!",\r\n  "content": {\r\n    "text/html": `\r\n      <h1>\xa1Hola {{name}}!</h1>\r\n      <p>Tu email {{email}} ha sido registrado exitosamente.</p>\r\n      <p>Saludos,<br>Equipo SIDIS</p>\r\n    `\r\n  },\r\n  "type": "email"\r\n});\n'})}),"\n",(0,i.jsx)(n.h3,{id:"sms-template",children:"SMS Template"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'db.Template.insertOne({\r\n  "_id": ObjectId("673abc123def456789012346"),\r\n  "name": "SMS Actualizaci\xf3n",\r\n  "content": "Hola {{name}}, tu informaci\xf3n ha sido actualizada en SIDIS. Si tienes dudas, cont\xe1ctanos.",\r\n  "type": "sms"\r\n});\n'})}),"\n",(0,i.jsx)(n.h2,{id:"ejemplos-de-creaci\xf3n-de-registros-type-task",children:'Ejemplos de Creaci\xf3n de Registros (type: "task")'}),"\n",(0,i.jsx)(n.h3,{id:"5-crear-tarea-de-seguimiento",children:"5. Crear Tarea de Seguimiento"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'// Crear tarea cuando se registra una nueva persona\r\ndb.WorkFlowConfig.insertOne({\r\n  "event": "peopleCreate",\r\n  "actions": [\r\n    {\r\n      "id": "followup_task",\r\n      "actionId": "task_001",\r\n      "type": "task",\r\n      "targetModule": "Task", // Crear en m\xf3dulo Task\r\n      "recordData": {\r\n        "title": "Seguimiento para {{name}}",\r\n        "description": "Contactar a {{name}} ({{email}}) para completar onboarding",\r\n        "priority": "high",\r\n        "status": "pending",\r\n        "assignedTo": "{{userId}}",\r\n        "dueDate": new Date(Date.now() + 24*60*60*1000), // 24 horas\r\n        "category": "onboarding"\r\n      }\r\n    }\r\n  ]\r\n});\n'})}),"\n",(0,i.jsx)(n.h3,{id:"6-crear-registro-de-backup-en-people",children:"6. Crear Registro de Backup en People"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'// Crear registro de backup cuando se actualiza una persona\r\ndb.WorkFlowConfig.insertOne({\r\n  "event": "peopleUpdate",\r\n  "actions": [\r\n    {\r\n      "id": "backup_person",\r\n      "actionId": "backup_001", \r\n      "type": "task",\r\n      "targetModule": "People", // Crear en m\xf3dulo People\r\n      "recordData": {\r\n        "name": "{{name}} - Backup",\r\n        "email": "backup-{{email}}",\r\n        "phone": "{{phone}}",\r\n        "source": "workflow-backup",\r\n        "originalId": "{{originalData._id}}",\r\n        "backupDate": "{{timestamp}}",\r\n        "tags": ["backup", "automated"]\r\n      }\r\n    }\r\n  ]\r\n});\n'})}),"\n",(0,i.jsx)(n.h3,{id:"7-crear-lead-en-crm",children:"7. Crear Lead en CRM"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'// Crear lead cuando se registra persona con email corporativo\r\ndb.WorkFlowConfig.insertOne({\r\n  "event": "peopleCreate",\r\n  "actions": [\r\n    {\r\n      "id": "create_lead",\r\n      "actionId": "lead_001",\r\n      "type": "task", \r\n      "targetModule": "Lead", // Crear en m\xf3dulo Lead\r\n      "recordData": {\r\n        "name": "{{name}}",\r\n        "email": "{{email}}",\r\n        "phone": "{{phone}}",\r\n        "source": "website-registration",\r\n        "status": "new",\r\n        "score": 75,\r\n        "assignedTo": "{{userId}}",\r\n        "notes": "Lead creado autom\xe1ticamente desde People",\r\n        "companySize": "unknown",\r\n        "budget": "unknown"\r\n      }\r\n    }\r\n  ]\r\n});\n'})}),"\n",(0,i.jsx)(n.h3,{id:"8-crear-entrada-de-auditor\xeda",children:"8. Crear Entrada de Auditor\xeda"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'// Crear log de auditor\xeda para todas las eliminaciones  \r\ndb.WorkFlowConfig.insertOne({\r\n  "event": "peopleDelete",\r\n  "actions": [\r\n    {\r\n      "id": "audit_deletion",\r\n      "actionId": "audit_001",\r\n      "type": "task",\r\n      "targetModule": "AuditLog", // Crear en m\xf3dulo AuditLog\r\n      "recordData": {\r\n        "action": "DELETE",\r\n        "module": "People",\r\n        "targetId": "{{originalData._id}}",\r\n        "userId": "{{userId}}",\r\n        "userName": "{{userName}}",\r\n        "timestamp": "{{timestamp}}",\r\n        "details": "Usuario {{userName}} elimin\xf3 a {{name}} ({{email}})",\r\n        "severity": "high",\r\n        "category": "data-deletion"\r\n      }\r\n    }\r\n  ]\r\n});\n'})}),"\n",(0,i.jsx)(n.h3,{id:"9-crear-m\xfaltiples-registros",children:"9. Crear M\xfaltiples Registros"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'// Workflow completo que crea registros en varios m\xf3dulos\r\ndb.WorkFlowConfig.insertOne({\r\n  "event": "peopleCreate",\r\n  "actions": [\r\n    {\r\n      "id": "welcome_email",\r\n      "type": "email",\r\n      "actionId": "email_001",\r\n      "templateId": "welcome_template_id"\r\n    },\r\n    {\r\n      "id": "create_task",\r\n      "type": "task",\r\n      "actionId": "task_001",\r\n      "targetModule": "Task",\r\n      "recordData": {\r\n        "title": "Onboarding: {{name}}",\r\n        "priority": "high",\r\n        "status": "pending"\r\n      }\r\n    },\r\n    {\r\n      "id": "create_company",\r\n      "type": "task", \r\n      "actionId": "company_001",\r\n      "targetModule": "Company",\r\n      "recordData": {\r\n        "name": "{{name}}\'s Organization",\r\n        "contactEmail": "{{email}}",\r\n        "status": "prospect"\r\n      }\r\n    },\r\n    {\r\n      "id": "create_opportunity",\r\n      "type": "task",\r\n      "actionId": "opp_001", \r\n      "targetModule": "Opportunity",\r\n      "recordData": {\r\n        "title": "Oportunidad inicial - {{name}}",\r\n        "contactName": "{{name}}",\r\n        "contactEmail": "{{email}}",\r\n        "stage": "prospecting",\r\n        "value": 1000,\r\n        "probability": 25\r\n      }\r\n    }\r\n  ]\r\n});\n'})}),"\n",(0,i.jsx)(n.h3,{id:"variables-disponibles-para-registros",children:"Variables Disponibles para Registros"}),"\n",(0,i.jsxs)(n.p,{children:["Las siguientes variables se reemplazan autom\xe1ticamente en ",(0,i.jsx)(n.code,{children:"recordData"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'// Variables de destinatario\r\n"{{name}}"       // Nombre del destinatario\r\n"{{email}}"      // Email del destinatario\r\n"{{phone}}"      // Tel\xe9fono del destinatario\r\n\r\n// Variables de trigger\r\n"{{userId}}"     // ID del usuario que dispar\xf3 el evento\r\n"{{userName}}"   // Nombre del usuario que dispar\xf3 el evento\r\n"{{moduleName}}" // M\xf3dulo donde ocurri\xf3 el evento (People, Company, etc.)\r\n"{{operation}}"  // Operaci\xf3n realizada (Create, Update, Delete)\r\n"{{timestamp}}"  // Timestamp del evento (ISO string)\r\n\r\n// Variables de datos originales\r\n"{{originalData._id}}"    // ID del registro original\r\n"{{originalData.field}}"  // Cualquier campo del registro original\r\n\r\n// Ejemplo de uso:\r\n{\r\n  "recordData": {\r\n    "title": "{{operation}} realizado en {{moduleName}}",\r\n    "description": "El usuario {{userName}} realiz\xf3 {{operation}} en {{name}}",\r\n    "relatedRecordId": "{{originalData._id}}",\r\n    "createdAt": "{{timestamp}}"\r\n  }\r\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"integraci\xf3n-autom\xe1tica",children:"Integraci\xf3n Autom\xe1tica"}),"\n",(0,i.jsx)(n.h3,{id:"flujo-de-operaciones-http",children:"Flujo de Operaciones HTTP"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'// 1. POST /people (Crear persona)\r\n// sidisChanges() recibe:\r\n// - data: {name: "Juan P\xe9rez", email: "juan@example.com", phone: "+1234567890"}\r\n// - moduleName: "People"  \r\n// - operation: "POST"\r\n// - user: {_id: "user123", name: "Admin"}\r\n\r\n// Procesamiento interno:\r\n// - POST se mapea a "Create"\r\n// - Evento generado: "peopleCreate"\r\n// - Busca WorkFlowConfig para "peopleCreate"\r\n// - Ejecuta acciones configuradas (email de bienvenida)\r\n\r\n// 2. PUT /people/670123456789012345678901 (Actualizar persona)\r\n// sidisChanges() recibe:\r\n// - data: {_id: "670123456789012345678901", name: "Juan P\xe9rez Updated", email: "juan@example.com"}\r\n// - moduleName: "People"\r\n// - operation: "PUT" \r\n// - user: {_id: "user123", name: "Admin"}\r\n\r\n// Procesamiento interno:\r\n// - PUT se mapea a "Update"\r\n// - Evento generado: "peopleUpdate"\r\n// - Busca WorkFlowConfig para "peopleUpdate"\r\n// - Ejecuta acciones configuradas (SMS de confirmaci\xf3n)\r\n\r\n// 3. DELETE /people/670123456789012345678901 (Eliminar persona)\r\n// sidisChanges() recibe:\r\n// - data: {_id: "670123456789012345678901", name: "Juan P\xe9rez", email: "juan@example.com"}\r\n// - moduleName: "People"\r\n// - operation: "DELETE"\r\n// - user: {_id: "user123", name: "Admin"}\r\n\r\n// Procesamiento interno:\r\n// - DELETE se mapea a "Delete"\r\n// - Evento generado: "peopleDelete"\r\n// - Busca WorkFlowConfig para "peopleDelete"\r\n// - Ejecuta acciones configuradas (email de confirmaci\xf3n de eliminaci\xf3n)\n'})}),"\n",(0,i.jsx)(n.h2,{id:"logs-del-sistema",children:"Logs del Sistema"}),"\n",(0,i.jsx)(n.p,{children:"En la consola del servidor ver\xe1s logs detallados:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Procesando evento: peopleCreate (operaci\xf3n original: POST)\r\nEjecutando workflow interno para evento: peopleCreate\r\nAcci\xf3n email (welcome_001) ejecutada: \xc9XITO\r\nWorkflow interno completado para peopleCreate. Resultados: 1\n"})}),"\n",(0,i.jsx)(n.h3,{id:"ejemplos-de-logs-por-operaci\xf3n",children:"Ejemplos de Logs por Operaci\xf3n"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Para POST /people:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Procesando evento: peopleCreate (operaci\xf3n original: POST)\r\nEjecutando workflow interno para evento: peopleCreate\r\nAcci\xf3n email (welcome_001) ejecutada: \xc9XITO\r\nWorkflow interno completado para peopleCreate. Resultados: 1\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Para PUT /people/123:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Procesando evento: peopleUpdate (operaci\xf3n original: PUT)\r\nEjecutando workflow interno para evento: peopleUpdate\r\nAcci\xf3n sms (update_001) ejecutada: \xc9XITO\r\nWorkflow interno completado para peopleUpdate. Resultados: 1\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Para DELETE /people/123:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Procesando evento: peopleDelete (operaci\xf3n original: DELETE)\r\nEjecutando workflow interno para evento: peopleDelete\r\nAcci\xf3n email (delete_001) ejecutada: \xc9XITO\r\nWorkflow interno completado para peopleDelete. Resultados: 1\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Si no hay configuraci\xf3n:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Procesando evento: peopleCreate (operaci\xf3n original: POST)\r\n(No aparecen m\xe1s logs - no hay configuraci\xf3n para este evento)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"testing",children:"Testing"}),"\n",(0,i.jsx)(n.h3,{id:"1-crear-configuraci\xf3n",children:"1. Crear configuraci\xf3n"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'db.WorkFlowConfig.insertOne({\r\n  "event": "peopleCreate",\r\n  "actions": [{\r\n    "id": "test_email",\r\n    "actionId": "test_001", \r\n    "type": "email"\r\n  }]\r\n});\n'})}),"\n",(0,i.jsx)(n.h3,{id:"2-crear-una-persona",children:"2. Crear una persona"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'// Esto autom\xe1ticamente disparar\xe1 el workflow\r\nconst person = await peopleModel.create({\r\n  name: "Test User",\r\n  email: "test@example.com"\r\n});\n'})}),"\n",(0,i.jsx)(n.h3,{id:"3-verificar-logs",children:"3. Verificar logs"}),"\n",(0,i.jsx)(n.p,{children:"Revisar la consola para ver los mensajes de ejecuci\xf3n del workflow."}),"\n",(0,i.jsx)(n.h2,{id:"variables-disponibles-en-templates",children:"Variables Disponibles en Templates"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"{{name}}"})," - Nombre de la persona"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"{{email}}"})," - Email de la persona"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"{{phone}}"})," - Tel\xe9fono de la persona"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"compatibilidad",children:"Compatibilidad"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u2705 ",(0,i.jsx)(n.strong,{children:"N8N"}),": Funcionalidad original mantenida"]}),"\n",(0,i.jsxs)(n.li,{children:["\u2705 ",(0,i.jsx)(n.strong,{children:"Action Controller"}),": Nueva funcionalidad agregada"]}),"\n",(0,i.jsxs)(n.li,{children:["\u2705 ",(0,i.jsx)(n.strong,{children:"Templates existentes"}),": Compatibles"]}),"\n",(0,i.jsxs)(n.li,{children:["\u2705 ",(0,i.jsx)(n.strong,{children:"Configuraciones existentes"}),": No afectadas"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["La implementaci\xf3n es ",(0,i.jsx)(n.strong,{children:"retrocompatible"})," y ",(0,i.jsx)(n.strong,{children:"no interfiere"})," con workflows existentes de N8N."]})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,a)=>{a.d(n,{R:()=>s,x:()=>l});var r=a(6540);const i={},o=r.createContext(i);function s(e){const n=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);